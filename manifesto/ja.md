# Vibe Modeling：自然言語によるCADインターフェース

*LLM駆動型パラメトリック3Dモデリングに関する技術的提案*

---

## 定義

**Vibe Modeling** とは、Large Language Model（LLM）に対して自然言語で指示を与え、パラメトリック3Dモデルを生成する手法である。LLMは人間の設計意図を実行可能なCADコードに変換し、そのコードは製造可能なジオメトリへとコンパイルされる。

本用語は **Vibe Coding** に由来する。Vibe Codingとは、自然言語プロンプトを介してソフトウェア開発をLLMに委任する確立された手法であり、Vibe Modelingはこのパラダイムをソースコードから物理的造形物へと拡張するものである。

```
入力: 「34mmトラックボールとPMW3360センサーマウントを内蔵する
       ケースを設計せよ。人間工学的パームレストおよびサイド
       ボタン2個を備え、サポート材なしで造形可能な形状とする」

  ↓  LLMがCadQuery（Python）コードを生成  ↓

出力: trackball_case.py → trackball_case.3mf → 製造
```

---

## 背景と動機

以下の3つの進展がVibe Modelingを実現可能にした。

**1. CADスクリプト言語におけるLLMの習熟**
現行世代のLLMは、自然言語仕様からCadQueryおよびOpenSCADの構文的・幾何学的に妥当なコードを安定して生成する能力を示している。CadQueryは本ワークフローに特に適している。PythonをベースとしているためLLMが最も高い精度でコード生成を行える言語基盤を活用でき、チェーンAPIにより可読性・監査性の高い出力が得られる。

**2. 幾何形状の中間表現としてのコード**
メッシュベースの3D生成（例：拡散モデルによるOBJ/STL直接出力）は非パラメトリックかつ編集不能な出力を生む。一方、コード生成によるモデルは本質的にパラメトリックである。単一の変数を変更すればモデル全体に伝播する。したがってVibe Modelingの出力は近似的なものではなく、完全にエンジニアリング可能である。

**3. メイカーコミュニティにおけるCADスキルギャップ**
コンシューマー向け3Dプリンターは広範な普及を達成した。しかしCADの習熟は独自設計にとって依然として重大な障壁である。3Dプリンティングコミュニティの相当数が、PrintablesやThingiverseなどのリポジトリから既製モデルに依存している。従来のCADソフトウェア（Fusion 360、SolidWorks、FreeCAD）の習得に数ヶ月から数年を要するためである。Vibe Modelingはこの障壁を、設計意図を自然言語で表現する能力にまで低減する。

---

## 技術アーキテクチャ

```
┌───────────────────────────────────────────────┐
│  設計意図（自然言語）                            │
│  「Raspberry Pi 5用の通気口付きケース。          │
│   壁厚2.5mm、M3マウントポスト、角丸処理」        │
└──────────────────┬────────────────────────────┘
                   │
                   ▼
┌───────────────────────────────────────────────┐
│  LLM（Claude 等）                              │
│  CadQuery Pythonコードを生成                    │
└──────────────────┬────────────────────────────┘
                   │
                   ▼
┌───────────────────────────────────────────────┐
│  CADカーネル                                   │
│  CadQuery (OpenCASCADE) → BREP評価             │
└──────────────────┬────────────────────────────┘
                   │
                   ▼
┌───────────────────────────────────────────────┐
│  エクスポート                                   │
│  STL / 3MF → スライサー → 製造                  │
└───────────────────────────────────────────────┘
```

### 推奨スタック

| レイヤー | 選択 | 根拠 |
|---------|------|------|
| LLM | Claude（Claude Code または API経由） | Python生成品質が高く、拡張コンテキストウィンドウを備える |
| CAD言語 | CadQuery | Python直結、BREPカーネル（OpenCASCADE）、フィレット/チャンファー操作がネイティブ |
| 実行環境 | ローカルPython環境 | 即時フィードバック、完全なデバッグ機能 |
| 出力形式 | STL / 3MF | STLは汎用互換性を確保。メタデータ保持が必要な場合は3MF |

### 出力形式について

CadQueryはプログラム上で `exporters.export()` を介してSTL、STEP、AMF、3MFへのエクスポートをサポートする。ただし、CQ-editorのGUIメニューからはSTLとSTEPのみがエクスポート可能である。実務上、**STLがVibe Modelingワークフローにおける主要出力形式**となる。すべてのスライサーおよび3Dプリンティングツールチェーンで普遍的にサポートされているためである。

単位、色、材料メタデータの保持が必要なプロジェクトでは、生成スクリプト内で直接3MFエクスポートを呼び出すことが可能である：

```python
from cadquery import exporters
exporters.export(result, "output.3mf")
```

主要スライサー（PrusaSlicer、Cura、Bambu Studio）はいずれの形式も問題なく受け入れる。STLが実用上のデフォルトであり、3MFはその追加機能が必要な場合に利用可能である。

---

## 従来のCADワークフローとの比較

| 評価基準 | 従来のCAD | Vibe Modeling |
|---------|----------|---------------|
| 入力モダリティ | GUI操作、パラメータ入力 | 自然言語による仕様記述 |
| 必要な訓練 | 数ヶ月〜数年 | 設計意図を言語化する能力 |
| イテレーション手法 | フィーチャーの手動編集 | 対話的改良（「壁厚を3mmに変更」） |
| パラメトリック出力 | モデリング規律に依存 | 本質的に保証（出力がソースコードであるため） |
| 寸法精度 | 完全制御 | 完全制御（生成コードは編集可能） |
| 再現性 | プロジェクトファイルの交換 | プロンプト＋スクリプトの配布 |

Vibe Modelingは複雑なマルチパートアセンブリ、公差厳密な量産設計、シミュレーション統合を要する設計において従来のCADを代替するものではない。その主要な適用領域は、個人製造プロジェクトの大半を占める機能部品——ケース、ブラケット、アダプター、マウント、オーガナイザー——の広範なカテゴリである。

---

## 原則

### 1. 形状ではなく機能を指定せよ

オブジェクトの形状ではなく、目的と制約から記述を開始する。LLMは機能要件から適切な形状を推論する。

> 「直径25mmのパイプにクリップ固定し、標準三脚ネジによりGoProを保持するマウント」

### 2. 対話的にイテレーションせよ

改良はコードの直接編集ではなく、自然言語により行う。

> 「クリップの締まりばめが過度である。径方向に0.5mmのクリアランスを追加せよ。加えて、すべての外部エッジに1mmフィレットを適用せよ」

### 3. 全出力を検証せよ

LLMは寸法的に不正確なジオメトリや、トポロジカルには妥当であるが製造不適な形状を生成する可能性がある。すべての出力は、CADビューアによる目視検査およびスライサー解析を経て製造に供すべきである。

### 4. パラメトリック構造を維持せよ

効果的なプロンプトは、モジュールレベルで明確に命名されたパラメータを持つコードを生成する——`TRACKBALL_DIAMETER = 34.0`、`WALL_THICKNESS = 2.5`、`FILLET_RADIUS = 1.0`——これにより再プロンプトなしでの修正が可能となる。

### 5. 成果物とともにプロンプトを配布せよ

Vibe Modelingによる設計を公開する際は、元のプロンプト、生成されたソースコード、およびコンパイル済み出力（STL/3MF）を含めること。これにより、共有メッシュファイルの不透明性とは対照的に、下流ユーザーによる完全な再現性と修正が可能となる。

---

## 環境構築と基本ワークフロー

### 環境準備

1. CadQueryのインストール：`conda install -c cadquery cadquery`
2. CQ-Editorによるインタラクティブプレビュー環境の構築（任意、ただし推奨）
3. LLMアクセスの設定（Claude: claude.ai、Claude Code、またはAPI経由）

### ワークフロー

1. 寸法制約、機能要件、製造上の考慮事項を含めてターゲット形状をLLMに記述する。
2. 生成されたCadQueryコードを受領する。
3. ローカルで実行する。CQ-Editorで検査するか、直接エクスポートする。
4. STLとしてエクスポートする（メタデータ保持が必要な場合はスクリプト経由で3MF）。
5. スライサーにインポートし、造形適性を検証した上で製造する。
6. 改良が必要な場合、修正内容をLLMに記述し、ステップ2から繰り返す。

### プロンプト例

> 「CadQueryでデスクトップ用スマートフォンスタンドのコードを記述せよ。要件：水平面から60度の角度でスマートフォンを保持、台座幅80mmで十分な奥行による安定性確保、台座中央に充電ケーブル用スロット（10mm×5mm）、壁厚2mm、全露出エッジに1.5mmフィレット。STLエクスポートを含めること」

---

## 今後の展望

- **ブラウザベースのリアルタイムプレビュー**：LLMコード生成とWebAssemblyコンパイルされたCadQueryの連携による、ローカルインストール不要の即時ブラウザ内可視化。
- **マルチパートアセンブリ生成**：複数部品設計における公差の自動計算およびスナップフィット/圧入ジョイントの自動生成。
- **材料特性対応ジオメトリ**：指定材料特性（PLA、PETG、TPU、レジン）に基づく壁厚、オーバーハング角度、フィーチャーサイズの自動調整。
- **プロンプトリポジトリ**：既存メッシュリポジトリを補完する、コミュニティ管理のVibe Modelingプロンプトライブラリ。設計意図レベルでのパラメトリックリミックスを可能とする。
- **VR/XR連携**：製造前のVR環境における生成モデルの空間的プレビューと評価。

---

## 結論

Vibe Modelingは特定のツール、ベンダー、プラットフォームに束縛されないオープンな方法論である。実装の詳細に先立って設計意図を置く実践であり、必要なものを言語化する能力を持つすべての者に対してパラメトリック3Dモデリングを開放する。

アイデアと物理的造形物の間の障壁は、かつてないほど薄くなった。

---

*ORFIZM — 2025*

*#VibeModeling #CadQuery #LLM #AdditiveManufacturing*
